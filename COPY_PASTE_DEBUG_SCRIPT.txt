â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FIREBASE SYNC DEBUG SCRIPT - COPY & PASTE IN BROWSER CONSOLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Open https://managerpetrolpump.vercel.app/
Press F12 to open Console
Copy and paste each section below, one at a time


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STEP 1: CHECK AUTHENTICATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Copy this and paste in Console:

const { auth } = require('./services/firebase');
const user = auth.currentUser;
console.log('â•â•â• AUTHENTICATION STATUS â•â•â•');
console.log('âœ… Authenticated:', !!user);
console.log('ğŸ“§ Email:', user?.email);
console.log('ğŸ†” User ID:', user?.uid);
console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STEP 2: CHECK LOCAL DATA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Copy this and paste in Console:

const localCustomers = JSON.parse(localStorage.getItem('customers') || '[]');
const localCredits = JSON.parse(localStorage.getItem('creditData') || '[]');
const localPayments = JSON.parse(localStorage.getItem('payments') || '[]');

console.log('â•â•â• LOCAL STORAGE DATA â•â•â•');
console.log('ğŸ“Š Customers:', localCustomers.length);
console.log('ğŸ’³ Credit Sales:', localCredits.length);
console.log('ğŸ’° Payments:', localPayments.length);

if (localCustomers.length > 0) {
  console.log('ğŸ‘¥ Customer Names:', localCustomers.map(c => c.name).join(', '));
}
console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STEP 3: CHECK FIREBASE DATA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Copy this and paste in Console:

const { collection, query, where, getDocs } = require('firebase/firestore');
const { db, auth } = require('./services/firebase');

const checkFirebase = async () => {
  const user = auth.currentUser;
  if (!user) {
    console.log('âŒ Not authenticated!');
    return;
  }
  
  console.log('â•â•â• FIREBASE DATA â•â•â•');
  
  // Check customers
  const customersSnap = await getDocs(
    query(collection(db, 'customers'), where('userId', '==', user.uid))
  );
  console.log('â˜ï¸ Customers in Firebase:', customersSnap.size);
  
  if (customersSnap.size > 0) {
    const names = [];
    customersSnap.forEach(doc => names.push(doc.data().name));
    console.log('ğŸ‘¥ Customer Names:', names.join(', '));
  }
  
  // Check credits
  const creditsSnap = await getDocs(
    query(collection(db, 'creditSales'), where('userId', '==', user.uid))
  );
  console.log('â˜ï¸ Credit Sales in Firebase:', creditsSnap.size);
  
  // Check payments
  const paymentsSnap = await getDocs(
    query(collection(db, 'payments'), where('userId', '==', user.uid))
  );
  console.log('â˜ï¸ Payments in Firebase:', paymentsSnap.size);
  
  console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
};

checkFirebase();


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STEP 4: FORCE PUSH TO FIREBASE (RUN ON LAPTOP 1 - HAS DATA)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Copy this and paste in Console on the laptop that HAS the data:

const forcePushToFirebase = async () => {
  console.log('ğŸš€ Starting force push to Firebase...');
  
  const firebaseSyncService = require('./services/firebaseSync').default;
  const { auth } = require('./services/firebase');
  
  if (!auth.currentUser) {
    console.log('âŒ Not authenticated!');
    return;
  }
  
  // Push customers
  const customers = JSON.parse(localStorage.getItem('customers') || '[]');
  console.log(`ğŸ“¤ Pushing ${customers.length} customers...`);
  
  for (const customer of customers) {
    try {
      await firebaseSyncService.syncCustomer(customer, 'add');
      console.log('âœ… Synced:', customer.name);
    } catch (error) {
      console.error('âŒ Failed:', customer.name, error.message);
    }
  }
  
  // Push credit sales
  const credits = JSON.parse(localStorage.getItem('creditData') || '[]');
  console.log(`ğŸ“¤ Pushing ${credits.length} credit sales...`);
  
  for (const credit of credits) {
    try {
      await firebaseSyncService.syncCreditSale(credit, 'add');
      console.log('âœ… Synced credit sale');
    } catch (error) {
      console.error('âŒ Failed credit sale:', error.message);
    }
  }
  
  // Push payments
  const payments = JSON.parse(localStorage.getItem('payments') || '[]');
  console.log(`ğŸ“¤ Pushing ${payments.length} payments...`);
  
  for (const payment of payments) {
    try {
      await firebaseSyncService.syncPayment(payment, 'add');
      console.log('âœ… Synced payment');
    } catch (error) {
      console.error('âŒ Failed payment:', error.message);
    }
  }
  
  console.log('âœ…âœ…âœ… FORCE PUSH COMPLETED! âœ…âœ…âœ…');
  console.log('Now check Firebase Console and run STEP 5 on Laptop 2');
};

forcePushToFirebase();


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STEP 5: FORCE PULL FROM FIREBASE (RUN ON LAPTOP 2 - NO DATA)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Copy this and paste in Console on the laptop that NEEDS the data:

const forcePullFromFirebase = async () => {
  console.log('ğŸ“¥ Starting force pull from Firebase...');
  
  const { collection, query, where, getDocs } = require('firebase/firestore');
  const { db, auth } = require('./services/firebase');
  
  const user = auth.currentUser;
  if (!user) {
    console.log('âŒ Not authenticated!');
    return;
  }
  
  console.log('ğŸ‘¤ Pulling data for user:', user.uid);
  
  // Pull customers
  const customersSnap = await getDocs(
    query(collection(db, 'customers'), where('userId', '==', user.uid))
  );
  
  const customers = [];
  customersSnap.forEach(doc => {
    const data = doc.data();
    customers.push(data);
    console.log('ğŸ“¥ Got customer:', data.name);
  });
  
  // Pull credit sales
  const creditsSnap = await getDocs(
    query(collection(db, 'creditSales'), where('userId', '==', user.uid))
  );
  
  const credits = [];
  creditsSnap.forEach(doc => {
    credits.push(doc.data());
  });
  
  // Pull payments
  const paymentsSnap = await getDocs(
    query(collection(db, 'payments'), where('userId', '==', user.uid))
  );
  
  const payments = [];
  paymentsSnap.forEach(doc => {
    payments.push(doc.data());
  });
  
  // Save to localStorage
  localStorage.setItem('customers', JSON.stringify(customers));
  localStorage.setItem('creditData', JSON.stringify(credits));
  localStorage.setItem('payments', JSON.stringify(payments));
  
  console.log('âœ…âœ…âœ… FORCE PULL COMPLETED! âœ…âœ…âœ…');
  console.log('ğŸ“Š Pulled data:');
  console.log('  - Customers:', customers.length);
  console.log('  - Credits:', credits.length);
  console.log('  - Payments:', payments.length);
  console.log('');
  console.log('ğŸ”„ Page will reload in 3 seconds...');
  
  setTimeout(() => {
    window.location.reload();
  }, 3000);
};

forcePullFromFirebase();


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STEP 6: TEST AUTO-SYNC (AFTER MANUAL SYNC WORKS)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

After manual push/pull works, test if auto-sync works:

1. On Laptop 1: Add a NEW customer called "Auto Sync Test"
2. On Laptop 2: Wait 5 seconds, then run this:

const testAutoSync = async () => {
  const { collection, query, where, getDocs } = require('firebase/firestore');
  const { db, auth } = require('./services/firebase');
  
  const customersSnap = await getDocs(
    query(collection(db, 'customers'), where('userId', '==', auth.currentUser.uid))
  );
  
  console.log('â˜ï¸ Total customers in Firebase:', customersSnap.size);
  
  const names = [];
  customersSnap.forEach(doc => names.push(doc.data().name));
  console.log('ğŸ‘¥ Customer Names:', names.join(', '));
  
  if (names.includes('Auto Sync Test')) {
    console.log('âœ…âœ…âœ… AUTO-SYNC WORKING! âœ…âœ…âœ…');
  } else {
    console.log('âŒ Auto-sync not working - customer not in Firebase yet');
  }
};

testAutoSync();


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TROUBLESHOOTING TIPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

If STEP 1 shows different User IDs:
â†’ You're using different accounts!
â†’ Logout and login with EXACT same email/password

If STEP 2 shows data but STEP 3 shows 0 in Firebase:
â†’ Data not pushing to Firebase
â†’ Run STEP 4 to force push

If STEP 3 shows data but STEP 2 shows 0:
â†’ Data not pulling from Firebase
â†’ Run STEP 5 to force pull

If manual sync works but auto-sync doesn't:
â†’ Listeners not working properly
â†’ Check browser console for error messages
â†’ Try clearing cache and hard reload

If you see errors about permissions:
â†’ Check Firebase security rules
â†’ Make sure documents have 'userId' field


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SHARE RESULTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

After running all steps, share:
1. Output from STEP 1 (both laptops)
2. Output from STEP 2 (both laptops)
3. Output from STEP 3 (both laptops)
4. Any error messages you see

This will help identify exactly what's wrong!
